<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rice Leaf Disease - MLOps Architecture</title>
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js"></script>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        .container {
            max-width: 1400px;
            margin: 0 auto;
        }
        .diagram-section {
            background: white;
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
        }
        h1 {
            color: white;
            text-align: center;
            margin-bottom: 30px;
            font-size: 2.5em;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }
        h2 {
            color: #667eea;
            margin-bottom: 20px;
            font-size: 1.8em;
            border-bottom: 3px solid #667eea;
            padding-bottom: 10px;
        }
        .mermaid {
            display: flex;
            justify-content: center;
            margin: 20px 0;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 10px;
        }
        .export-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 8px;
            font-size: 16px;
            cursor: pointer;
            margin: 10px 5px;
            transition: all 0.3s;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
        }
        .export-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.6);
        }
        .button-group {
            text-align: center;
            margin-top: 20px;
        }
        .instructions {
            background: #e8eaf6;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 30px;
            border-left: 5px solid #667eea;
        }
        .instructions h3 {
            color: #667eea;
            margin-top: 0;
        }
        .instructions ol {
            margin: 10px 0;
            padding-left: 20px;
        }
        .instructions li {
            margin: 8px 0;
            line-height: 1.6;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ—ï¸ Rice Leaf Disease Classification - System Architecture</h1>

        <div class="instructions">
            <h3>ğŸ“¸ CÃ¡ch xuáº¥t sÆ¡ Ä‘á»“ thÃ nh hÃ¬nh áº£nh:</h3>
            <ol>
                <li><strong>Screenshot trá»±c tiáº¿p:</strong> Sá»­ dá»¥ng Windows Snipping Tool (Win + Shift + S) Ä‘á»ƒ chá»¥p mÃ n hÃ¬nh</li>
                <li><strong>Click chuá»™t pháº£i:</strong> VÃ o sÆ¡ Ä‘á»“ â†’ "Save image as..." (má»™t sá»‘ browser há»— trá»£)</li>
                <li><strong>Browser DevTools:</strong> F12 â†’ Inspect element cá»§a SVG â†’ Right-click â†’ Copy â†’ Save as SVG</li>
                <li><strong>Online Export:</strong> Copy code Mermaid dÆ°á»›i Ä‘Ã¢y â†’ Paste vÃ o <a href="https://mermaid.live" target="_blank" style="color: #667eea; font-weight: bold;">mermaid.live</a> â†’ Export PNG/SVG</li>
            </ol>
        </div>

        <!-- Diagram 1: System Architecture -->
        <div class="diagram-section">
            <h2>ğŸ“Š System Architecture</h2>
            <div class="mermaid">
graph TB
    subgraph "Data Layer"
        A1[("ğŸ—‚ï¸ Training Data<br/>2,100 images")]
        A2[("ğŸ—‚ï¸ Validation Data<br/>528 images")]
    end

    subgraph "Training & Experiment Tracking"
        B1["ğŸ¯ PyTorch Training<br/>(3 Models)"]
        B2[("ğŸ“Š MLflow Tracking<br/>Experiments & Metrics")]
        B3[("ğŸ† Model Registry<br/>Production Models")]
    end

    subgraph "Orchestration"
        C1["âš™ï¸ Apache Airflow"]
        C2["ğŸ“‹ Training DAG"]
        C3["ğŸš€ Deployment DAG"]
    end

    subgraph "API & Serving"
        D1["ğŸŒ FastAPI Service"]
        D2["ğŸ³ Docker Container"]
    end

    subgraph "Monitoring"
        E1["ğŸ“ˆ Prometheus"]
        E2["ğŸ“Š Grafana"]
    end

    A1 --> B1
    A2 --> B1
    B1 --> B2
    B2 --> B3
    C1 --> C2
    C1 --> C3
    C2 --> B1
    C3 --> D2
    B3 --> C3
    D2 --> D1
    D1 --> E1
    E1 --> E2

    style A1 fill:#e1f5ff,stroke:#01579b,stroke-width:2px
    style A2 fill:#e1f5ff,stroke:#01579b,stroke-width:2px
    style B1 fill:#fff3e0,stroke:#e65100,stroke-width:2px
    style B2 fill:#f3e5f5,stroke:#4a148c,stroke-width:2px
    style B3 fill:#f3e5f5,stroke:#4a148c,stroke-width:2px
    style C1 fill:#e8f5e9,stroke:#1b5e20,stroke-width:2px
    style C2 fill:#e8f5e9,stroke:#2e7d32,stroke-width:2px
    style C3 fill:#e8f5e9,stroke:#2e7d32,stroke-width:2px
    style D1 fill:#fce4ec,stroke:#880e4f,stroke-width:2px
    style D2 fill:#fce4ec,stroke:#c2185b,stroke-width:2px
    style E1 fill:#fff9c4,stroke:#f57f17,stroke-width:2px
    style E2 fill:#fff9c4,stroke:#f57f17,stroke-width:2px
            </div>
            <div class="button-group">
                <button class="export-btn" onclick="copyToClipboard('diagram1')">ğŸ“‹ Copy Mermaid Code</button>
                <button class="export-btn" onclick="window.open('https://mermaid.live', '_blank')">ğŸŒ Open in Mermaid.live</button>
            </div>
        </div>

        <!-- Diagram 2: MLOps Workflow -->
        <div class="diagram-section">
            <h2>ğŸ”„ Complete MLOps Workflow</h2>
            <div class="mermaid">
flowchart TD
    subgraph "1ï¸âƒ£ Data & Training"
        S1["ğŸ“¥ Load Dataset"] --> S2["ğŸ”„ Augmentation"]
        S2 --> T1["ğŸ¯ Select Model"]
        T1 --> T2["ğŸ‹ï¸ Train & Validate"]
        T2 --> T3{"ğŸ›‘ Early Stop?"}
        T3 -->|No| T2
        T3 -->|Yes| T4["ğŸ’¾ Save Best Model"]
    end

    subgraph "2ï¸âƒ£ Experiment Tracking"
        E1["ğŸ“Š Log Metrics<br/>(Accuracy, F1)"] --> E2["ğŸ’¾ Save Artifacts"]
        E2 --> E3["ğŸ” Compare Models"]
        E3 --> R1{"ğŸ† Best Model?"}
        R1 -->|Yes| R2["ğŸ“ Register to<br/>Production"]
        R1 -->|No| R3["â­ï¸ Skip"]
    end

    subgraph "3ï¸âƒ£ CI/CD & Deployment"
        D1["ğŸ” Tests & Build"] --> D2["ğŸ³ Docker Image"]
        D2 --> D3["ğŸ­ Deploy Staging"]
        D3 --> D4{"âœ… Health OK?"}
        D4 -->|No| D5["â®ï¸ Rollback"]
        D4 -->|Yes| D6["ğŸŒŸ Production"]
    end

    subgraph "4ï¸âƒ£ Monitoring & Feedback"
        M1["ğŸ“Š Prometheus<br/>Collect Metrics"] --> M2["ğŸ“ˆ Grafana<br/>Dashboards"]
        M2 --> M3{"âš ï¸ Issue?"}
        M3 -->|Yes| M4["ğŸ”„ Retrain"]
        M3 -->|No| M5["âœ… Continue"]
    end

    T4 --> E1
    R2 --> D1
    R3 --> D1
    D6 --> M1
    M4 --> S1
    M5 --> M1

    style S1 fill:#e3f2fd,stroke:#1565c0,stroke-width:2px
    style S2 fill:#e3f2fd,stroke:#1976d2,stroke-width:2px
    style T1 fill:#fff3e0,stroke:#e65100,stroke-width:2px
    style T2 fill:#ffe0b2,stroke:#ef6c00,stroke-width:2px
    style T3 fill:#ffcc80,stroke:#f57c00,stroke-width:2px
    style T4 fill:#ffa726,stroke:#ff9800,stroke-width:2px
    style E1 fill:#f3e5f5,stroke:#6a1b9a,stroke-width:2px
    style E2 fill:#e1bee7,stroke:#7b1fa2,stroke-width:2px
    style E3 fill:#ce93d8,stroke:#8e24aa,stroke-width:2px
    style R1 fill:#fff9c4,stroke:#f57f17,stroke-width:2px
    style R2 fill:#ffeb3b,stroke:#fbc02d,stroke-width:2px
    style R3 fill:#9e9e9e,stroke:#424242,stroke-width:2px
    style D1 fill:#e0f2f1,stroke:#00695c,stroke-width:2px
    style D2 fill:#b2dfdb,stroke:#00796b,stroke-width:2px
    style D3 fill:#80cbc4,stroke:#00897b,stroke-width:2px
    style D4 fill:#4db6ac,stroke:#009688,stroke-width:2px
    style D5 fill:#f44336,stroke:#c62828,stroke-width:2px,color:#fff
    style D6 fill:#66bb6a,stroke:#388e3c,stroke-width:3px,color:#fff
    style M1 fill:#ffccbc,stroke:#d84315,stroke-width:2px
    style M2 fill:#ffab91,stroke:#e64a19,stroke-width:2px
    style M3 fill:#ff8a65,stroke:#f4511e,stroke-width:2px
    style M4 fill:#ff5252,stroke:#d32f2f,stroke-width:2px,color:#fff
    style M5 fill:#81c784,stroke:#388e3c,stroke-width:2px,color:#fff
            </div>
            <div class="button-group">
                <button class="export-btn" onclick="copyToClipboard('diagram2')">ğŸ“‹ Copy Mermaid Code</button>
                <button class="export-btn" onclick="window.open('https://mermaid.live', '_blank')">ğŸŒ Open in Mermaid.live</button>
            </div>
        </div>

        <div class="instructions" style="background: #fff3e0; border-left-color: #ff9800;">
            <h3>ğŸ’¡ Tips cho hÃ¬nh áº£nh Ä‘áº¹p nháº¥t:</h3>
            <ol>
                <li><strong>Äá»™ phÃ¢n giáº£i cao:</strong> Zoom browser lÃªn 150-200% trÆ°á»›c khi screenshot</li>
                <li><strong>Export SVG:</strong> DÃ¹ng mermaid.live Ä‘á»ƒ export SVG (vector, scale khÃ´ng máº¥t cháº¥t lÆ°á»£ng)</li>
                <li><strong>Transparent background:</strong> Export SVG rá»“i convert sang PNG vá»›i ná»n trong suá»‘t</li>
                <li><strong>Theme:</strong> SÆ¡ Ä‘á»“ Ä‘Ã£ Ä‘Æ°á»£c style sáºµn vá»›i mÃ u sáº¯c Ä‘áº¹p, cÃ¢n nháº¯c dÃ¹ng dark theme náº¿u cáº§n</li>
            </ol>
        </div>
    </div>

    <script>
        mermaid.initialize({
            startOnLoad: true,
            theme: 'default',
            securityLevel: 'loose',
            flowchart: {
                useMaxWidth: true,
                htmlLabels: true,
                curve: 'basis'
            }
        });

        function copyToClipboard(diagramId) {
            const diagrams = {
                'diagram1': `graph TB
    subgraph "Data Layer"
        A1[("ğŸ—‚ï¸ Training Data<br/>2,100 images")]
        A2[("ğŸ—‚ï¸ Validation Data<br/>528 images")]
    end

    subgraph "Training & Experiment Tracking"
        B1["ğŸ¯ PyTorch Training<br/>(3 Models)"]
        B2[("ğŸ“Š MLflow Tracking<br/>Experiments & Metrics")]
        B3[("ğŸ† Model Registry<br/>Production Models")]
    end

    subgraph "Orchestration"
        C1["âš™ï¸ Apache Airflow"]
        C2["ğŸ“‹ Training DAG"]
        C3["ğŸš€ Deployment DAG"]
    end

    subgraph "API & Serving"
        D1["ğŸŒ FastAPI Service"]
        D2["ğŸ³ Docker Container"]
    end

    subgraph "Monitoring"
        E1["ğŸ“ˆ Prometheus"]
        E2["ğŸ“Š Grafana"]
    end

    A1 --> B1
    A2 --> B1
    B1 --> B2
    B2 --> B3
    C1 --> C2
    C1 --> C3
    C2 --> B1
    C3 --> D2
    B3 --> C3
    D2 --> D1
    D1 --> E1
    E1 --> E2

    style A1 fill:#e1f5ff,stroke:#01579b,stroke-width:2px
    style A2 fill:#e1f5ff,stroke:#01579b,stroke-width:2px
    style B1 fill:#fff3e0,stroke:#e65100,stroke-width:2px
    style B2 fill:#f3e5f5,stroke:#4a148c,stroke-width:2px
    style B3 fill:#f3e5f5,stroke:#4a148c,stroke-width:2px
    style C1 fill:#e8f5e9,stroke:#1b5e20,stroke-width:2px
    style C2 fill:#e8f5e9,stroke:#2e7d32,stroke-width:2px
    style C3 fill:#e8f5e9,stroke:#2e7d32,stroke-width:2px
    style D1 fill:#fce4ec,stroke:#880e4f,stroke-width:2px
    style D2 fill:#fce4ec,stroke:#c2185b,stroke-width:2px
    style E1 fill:#fff9c4,stroke:#f57f17,stroke-width:2px
    style E2 fill:#fff9c4,stroke:#f57f17,stroke-width:2px`,
                'diagram2': `flowchart TD
    subgraph "1ï¸âƒ£ Data & Training"
        S1["ğŸ“¥ Load Dataset"] --> S2["ğŸ”„ Augmentation"]
        S2 --> T1["ğŸ¯ Select Model"]
        T1 --> T2["ğŸ‹ï¸ Train & Validate"]
        T2 --> T3{"ğŸ›‘ Early Stop?"}
        T3 -->|No| T2
        T3 -->|Yes| T4["ğŸ’¾ Save Best Model"]
    end

    subgraph "2ï¸âƒ£ Experiment Tracking"
        E1["ğŸ“Š Log Metrics<br/>(Accuracy, F1)"] --> E2["ğŸ’¾ Save Artifacts"]
        E2 --> E3["ğŸ” Compare Models"]
        E3 --> R1{"ğŸ† Best Model?"}
        R1 -->|Yes| R2["ğŸ“ Register to<br/>Production"]
        R1 -->|No| R3["â­ï¸ Skip"]
    end

    subgraph "3ï¸âƒ£ CI/CD & Deployment"
        D1["ğŸ” Tests & Build"] --> D2["ğŸ³ Docker Image"]
        D2 --> D3["ğŸ­ Deploy Staging"]
        D3 --> D4{"âœ… Health OK?"}
        D4 -->|No| D5["â®ï¸ Rollback"]
        D4 -->|Yes| D6["ğŸŒŸ Production"]
    end

    subgraph "4ï¸âƒ£ Monitoring & Feedback"
        M1["ğŸ“Š Prometheus<br/>Collect Metrics"] --> M2["ğŸ“ˆ Grafana<br/>Dashboards"]
        M2 --> M3{"âš ï¸ Issue?"}
        M3 -->|Yes| M4["ğŸ”„ Retrain"]
        M3 -->|No| M5["âœ… Continue"]
    end

    T4 --> E1
    R2 --> D1
    R3 --> D1
    D6 --> M1
    M4 --> S1
    M5 --> M1

    style S1 fill:#e3f2fd,stroke:#1565c0,stroke-width:2px
    style S2 fill:#e3f2fd,stroke:#1976d2,stroke-width:2px
    style T1 fill:#fff3e0,stroke:#e65100,stroke-width:2px
    style T2 fill:#ffe0b2,stroke:#ef6c00,stroke-width:2px
    style T3 fill:#ffcc80,stroke:#f57c00,stroke-width:2px
    style T4 fill:#ffa726,stroke:#ff9800,stroke-width:2px
    style E1 fill:#f3e5f5,stroke:#6a1b9a,stroke-width:2px
    style E2 fill:#e1bee7,stroke:#7b1fa2,stroke-width:2px
    style E3 fill:#ce93d8,stroke:#8e24aa,stroke-width:2px
    style R1 fill:#fff9c4,stroke:#f57f17,stroke-width:2px
    style R2 fill:#ffeb3b,stroke:#fbc02d,stroke-width:2px
    style R3 fill:#9e9e9e,stroke:#424242,stroke-width:2px
    style D1 fill:#e0f2f1,stroke:#00695c,stroke-width:2px
    style D2 fill:#b2dfdb,stroke:#00796b,stroke-width:2px
    style D3 fill:#80cbc4,stroke:#00897b,stroke-width:2px
    style D4 fill:#4db6ac,stroke:#009688,stroke-width:2px
    style D5 fill:#f44336,stroke:#c62828,stroke-width:2px,color:#fff
    style D6 fill:#66bb6a,stroke:#388e3c,stroke-width:3px,color:#fff
    style M1 fill:#ffccbc,stroke:#d84315,stroke-width:2px
    style M2 fill:#ffab91,stroke:#e64a19,stroke-width:2px
    style M3 fill:#ff8a65,stroke:#f4511e,stroke-width:2px
    style M4 fill:#ff5252,stroke:#d32f2f,stroke-width:2px,color:#fff
    style M5 fill:#81c784,stroke:#388e3c,stroke-width:2px,color:#fff`
            };

            const code = diagrams[diagramId];
            navigator.clipboard.writeText(code).then(() => {
                alert('âœ… Mermaid code Ä‘Ã£ Ä‘Æ°á»£c copy! Paste vÃ o mermaid.live Ä‘á»ƒ export hÃ¬nh áº£nh.');
            });
        }
    </script>
</body>
</html>
